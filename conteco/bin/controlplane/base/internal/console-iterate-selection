#!/usr/bin/env bash

selector="${@: -1}"
selection=$(cat /conteco/assets/image-list | grep "${CONTECO_ECOSYSTEM_RUNTIME}.${selector}")
readarray -t items <<< "$selection"
  for item in ${items[@]};
  do
    imageName="${CONTECO_REALM_RUNTIME}/$item"
    current=$(pwd)
    if [[ -d "$imageName" ]] ; then
      cd "$imageName"
    fi
    commandline="${@:1:$#-1}"
    if [[ "$commandline" == ".invoke console cmd"* ]] ; then
      $commandline
    else
      $commandline $imageName
    fi
    cd $current
  done;
