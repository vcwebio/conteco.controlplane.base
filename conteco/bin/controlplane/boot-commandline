#!/usr/bin/env bash
echo ""
echo "boot-commandline expects up to 2 arguments:"
echo "mandatory: windows or linx"
echo "optional: sudo (on linux only)"
echo ""
if [[ "$1" == "linux" ]] ; then
  . linux
elif [[ "$1" == "windows" ]] ; then
  . windows
else
  echo "PLEASE PROVIDE OPERATING SYSTEM ARGUMENT: linux  OR windows"
  echo ""
  echo ""
  exit
fi
export CONTECO_PWD_VOLUME="$1"
echo "Extracting controlplane.base start method."
echo ""
if [[ "$CONTECO_OS" != "linux" ]] ; then
    cat /conteco/extract/start-output-console | envsubst > "/conteco/pwd/start-output-console.bat"
	cat /conteco/extract/start-registry | envsubst > "/conteco/pwd/start-registry.bat"
	cat /conteco/extract/start.bat | envsubst > "/conteco/pwd/start.bat"
	echo "(Windows) Run: start.bat [conteco/modeco] [realm] to start the controlplane for conteco, modeco resp."
fi
if [[ "$CONTECO_OS" != "windows" ]] ; then
	if [[ "$3" == "sudo" ]] ; then
		export CONTECO_SUDO="sudo "
	fi
	cat /conteco/extract/start-output-console | envsubst > "/conteco/pwd/start-output-console"
	cat /conteco/extract/start-registry | envsubst > "/conteco/pwd/start-registry"
	cat /conteco/extract/start | envsubst '${CONTECO_SUDO} ${CONTECO_REALM} ${CONTECO_ECOSYSTEM}' > "/conteco/pwd/start"
	echo "(linux) Run: ./start [conteco/modeco] [realm] to start the controlplane for conteco, modeco resp."
fi
echo "The realm (account) is the name of the folder containing the repositories."
echo ""
echo "Use the --help flag to get more information on conteco, modeco and their APIs."
echo ""
echo ""
chmod -R 777 /conteco
