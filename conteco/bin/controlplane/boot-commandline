#!/usr/bin/env bash

echo "Extracting controlplane.base start method."
if [[ "$CONTECO_OS" != "linux" ]] ; then
    (cat /conteco/extract/start-output-console ) | envsubst > "/conteco/pwd/start-output-console.bat"
	(cat /conteco/extract/start-registry ) | envsubst > "/conteco/pwd/start-registry.bat"
	(cat /conteco/extract/start.bat ) | envsubst > "/conteco/pwd/start.bat"
fi
if [[ "$CONTECO_OS" != "windows" ]] ; then
	if [[ "$1" == "sudo" ]] ; then
		export CONTECO_SUDO="sudo "
	fi
    (cat /conteco/extract/start-output-console ) | envsubst > "/conteco/pwd/start-output-console"
	(cat /conteco/extract/start-registry ) | envsubst > "/conteco/pwd/start-registry"
	(cat /conteco/extract/start ) | envsubst "$CONTECO_SUDO,$CONTECO_REALM,$CONTECO_ECOSYSTEM" > "/conteco/pwd/start"
fi

chmod 777 /conteco/pwd/start*
echo ""
echo "Run start (linux) / start.bat (windows) to start the controlplane."
echo ""
